<!--?xml version="1.0" ?-->
<!DOCTYPE pdf PUBLIC "-//big.faceless.org//report" "report-1.1.dtd">
<pdf>
<head>
    <style type="text/css">

        u {
                font-family: sans-serif;
        }
        b {
            color: #444;
            font-weight: bold;
            font-family: sans-serif;
        }
        h3 {
        font-family: sans-serif;
        font-size: 10pt;
        color: #888;
        font-weight: bold;
        font-style:normal;
        text-align:center;

        }

        h2 {
            font-family: sans-serif;
            font-size: 13pt;
            color: #444;
            font-weight: bold;

        }

        table {
            margin-top: 10px;
            font-family: sans-serif;
            font-size: 10pt;
            table-layout: fixed;
            width: 90%;
        }

        th {
            font-weight: bold;
            font-size: 8pt;
            vertical-align: middle;
            padding-top: 5px;
            padding-right: 6px;
            padding-left: 10px;
            padding-bottom: 3px;
            color: #fff;
            height: 10px;
        }

        td {
            padding-bottom: 4px;
            padding-top: 4px;
            padding-right: 6px;
            padding-left: 10px;
            vertical-align: middle;
        }

        table.body td {
            padding-top: 2px;
            padding-right: 1px;
        }


        table.header td {
            font-size: 8pt;
            padding: 0px;
        }

        table.footer td {
            font-size: 8pt;
            padding: 0px;
        }

        .footer {
            background-color: #F1F1F2;
            width: 100%;
            font-size: 14px;
            font-family: sans-serif;
            padding: 50px;
            padding-top: 10px;
            margin: 0px;
        }

        .terms {
            font-family: sans-serif;
            color: #555;
            /*text-overflow: ellipsis;
            overflow: hidden;*/
            /*white-space: nowrap;*/
            font-size: 9pt;
        }

        .header {
            width: 100%;
            padding: 0px;
            font-family: sans-serif;
            margin: 0px;
            padding: 5px;
        }


        table.linetb th {
            background-color: #ddd;
            font-weight: bold;
            font-family: sans-serif;
            color: #777;
            border: 0px;
        }

        table.linetb td {
            background-color: #fff;
            color: #777;
            /*text-overflow: ellipsis;
            white-space: nowrap;*/
            border: 0px;
            font-family: sans-serif;
            font-size: 8pt;
            padding-right: 1px;
            padding-left: 5px;
        }

        table.headertable th {
            background-color: #d3d3d3;
            color: #555;
            white-space: nowrap;
            border: 1px solid #686666;
            font-size: 9pt;
            padding-left: 5px;
        }

        table.headertable td {
            background-color: #fff;
            color: #555;
            white-space: nowrap;
            border: 1px solid #686666;
            font-family: sans-serif;
            font-size: 9pt;
            padding-left: 5px;
        }


        td.default {
            font-size: 9pt;
            font-family: sans-serif;
            padding-top: 0px;
            padding-bottom: 0px;
        }

        table.total {
            page-break-inside: avoid;
            font-family: sans-serif;
            font-size: 10pt;
            padding-right: 20px;
        }

        span.desc {
            font-weight: bold;
            line-height: 150%;
            font-family: sans-serif;
        }

        hr {
            height: 1px;
            width: 100%;
            color: #d3d3d3;
            background-color: #d3d3d3;
        }

        .title {
            color: #6D6E70;
            font-size: 10px !important;
            font-family: sans-serif;
        }

        .title2 {
            color: #444;
            font-size: 12px !important;
            font-family: sans-serif;
        }
        .maintitle {
            color: #32338A;
            font-family: sans-serif;
        }

        .maintext {
            font-size: 20px;
            font-family: sans-serif;
        }
    </style>

    <macrolist>  	
        <macro id="nlheader">

             <table border="0" cellpadding="0" class="header">
                 <tr>
                     <td style="width:80%"><#if subsidiary.logo@url?length != 0><img src="${subsidiary.logo@url}" style="width:180px; height:60px;" /> </#if> </td>
                     <td style="text-align:right;"></td>
                 </tr>
            </table>
        
        </macro>
        <macro id="nlfooter">
            <table style="width: 100%; font-size: 8pt;"><tr>
	            <td align="right" style="padding: 0;">Page <pagenumber/> of <totalpages/></td>
	            </tr></table>
         </macro>
    </macrolist>
</head>


<body padding="15" margin="15" size="A4" footer="nlfooter" footer-height="40px"  header="nlheader" header-height="100px" style="border:2px;">
  <table>
    <tr>
     <td>
      <table style="width:300px;padding-top:10px; border:1px solid #333 ">
        <tr>
          <td class="title" ><u>${subsidiary.name}</u> <br /><span >Tax number: ${subsidiary.custrecordil_tax_payer_id_subsidary}</span ><span > ${subsidiary.mainaddress_text?replace(subsidiary.name,'')}<br /><br /></span></td>
        </tr>
        </table>
       </td>
      <td >
        <table style="width:340px;padding-top:10px; margin-left:150px ">
        <tr>
          <td class="title" ><b>Cybersecurity Consulting Services</b></td>
          </tr>
          <tr>
            <td align="center" class="title"> Date: ${record.trandate?string("MMMM dd yyyy")}</td>
        </tr>
        </table>
      </td>
  </tr>
  <tr>
    <td>
        <table style="width:300px;padding-top:10px; border:1px solid #333 ">
        <tr>
          <td class="title" ><b>To:</b> <br /><span > ${record.billaddress?replace(record.entity.altname,record.entity.custentity_sygnia_client_name)}<br />
              <#if (record.entity.custentityil_tax_payer_id != "" &&  !record.entity.custentityil_tax_payer_id?contains('99999999'))>
              ${record.entity.custentityil_tax_payer_id} <br /> <br /> </#if>
              </span></td>
        </tr>
        </table>
      </td>
    <td></td>
    </tr>
</table>
    <#assign amounttotal = 0> 
    <#assign totalonsite = 0>
     <#assign totaloffsite = 0>
    <#assign primarycur_exchange =  record.exchangerate> 
    <#assign secondary_exchange = 1> 
    <#assign total_exchange = 1> 
    <#assign total_travel = 0> 
    <#assign total_expenses = 0> 
    <#assign total_accommodation = 0> 
    <#assign total_offsite = 0> 
    <#assign total_onsite = 0> 
       <#assign rate_offsite = 0> 
    <#assign rate_onsite = 1>
      <#assign daysorhours = 'hours'> 
    <#assign daysorhours_capital = 'HOURS'> 

    <#if ((record.custbody_calc_prof_services_days?has_content) && (record.custbody_calc_prof_services_days))>
          <#assign daysorhours = 'days'> 
          <#assign daysorhours_capital = 'DAYS'> 
    </#if>
<#assign currency_text = record.currency> 
        <#assign currency_symbol = record.currency?replace('USD','$')> 
     
    <#if record.accountingbookdetail?has_content>
    <#list record.accountingbookdetail as abd>
    <#assign secondary_exchange = abd.exchangerate> 
    </#list>
    </#if>
        <#assign samerateforonandoffsite = false> 

         <#if record.item?has_content>
        <#list record.item as item>
            <#if (item.item?index_of("Off Site")>=0)>
             <#assign total_offsite = item.quantity>
                 <#assign rate_offsite = item.rate>
        </#if>
            <#if (item.item?index_of("On Site")>=0)>
              <#assign total_onsite =  item.quantity> 
                    <#assign rate_onsite = item.rate>
         </#if>
            <#if rate_onsite == rate_offsite>
              <#assign samerateforonandoffsite = true> 
            </#if>
        </#list><!-- end items -->
        </#if>
      
    
      <table style="width:640px">
        <tr>
        <td style="padding-left:40%; font-weight:bold"> <span class="title" >Invoice number ${record.tranid} </span> </td>
        </tr>
      </table>
    <br />
    <#assign total_lines = 0> 
     <#if record.item?has_content>
        <table  style="width:640px;margin-top: -20px;"  class="linetb" ><!-- start items -->
    <#list record.item as item>    
            <#assign total_lines = item_index> 
    <#if item_index==0>

    <thead>
    <tr>
        <th colspan="7">Item</th>
        <th  colspan="3" align="left">Rate</th>
        <th  colspan="3"  align="center">Quantity</th>
        <th  colspan="2">Fees</th>
     </tr>
    </thead>
    </#if>
 <#if  record.subsidiary == 'Sygnia INC'>

         <tr >
            <td  colspan="7" style="text-align:justify; text-justify:none; color:#6D6E70 !important;">  ${item.description}</td>
            <td  colspan="3" align="left" ><#if (item.rate > 0)>${currency_symbol} ${(item.rate  * total_exchange)?string[",##0"]}  </#if></td>
            <td colspan="3" align="center"><span class="desc">${item.quantity}</span></td>
            <td  colspan="2"  align="right"  >${currency_symbol} ${(item.amount  * total_exchange)?string[",##0"]} </td>
        </tr>
<#else>


     <#if ((item.item?index_of("Site")>=0) || (item.description?index_of("Discount") >= 0)) >
<#if samerateforonandoffsite>
        <#if (item.rate!= 0  && (item.rate?has_content )) >
        <#if (item.item?index_of("On Site")>=0) >
             <tr >
                    <td  colspan="7" style="text-align:justify; text-justify:none; color:#6D6E70 !important;"> ${item.description}  </td>
                    <td  colspan="3" align="left" ><#if (item.rate > 0)>${currency_symbol} ${(item.rate  * total_exchange)?string[",##0"]} </#if></td>
                    <td colspan="3" align="center"><span class="desc">${total_onsite + total_offsite}</span></td>
                    <td  colspan="2"  align="right">${currency_symbol} ${(item.rate  * total_exchange * (total_onsite + total_offsite))?string[",##0"]}</td>
            </tr>
         </#if>
         </#if>
        <#if (item.description?index_of("Discount") >= 0) > 
         <tr style=" padding-bottom:10px;">
            <td  colspan="7" style="text-align:justify; text-justify:none; color:#6D6E70 !important;">  ${item.description}   (${item.item})  </td>
            <td  colspan="3" align="left" > <#if (item.rate > 0)>${currency_symbol} ${(item.rate  * total_exchange)?string[",##0"]} </#if></td>
            <td colspan="3" align="center"><span class="desc">${item.quantity}</span></td>
            <td  colspan="2"  align="right"  >${currency_symbol} (${(item.amount  * total_exchange * (-1))?string[",##0"]}) </td>

         </tr>
       </#if>

<#else>
    <#if (item.rate!= 0  && item.rate?has_content) >
        <#if (item.item?index_of("Discount") >= 0) > 
   
       <#else>
         <tr >
            <td  colspan="7" style="text-align:justify; text-justify:none; color:#6D6E70 !important;">  ${item.description}   (${item.item})  </td>
            <td  colspan="3" align="left" ><#if (item.rate > 0)>${currency_symbol} ${(item.rate  * total_exchange)?string[",##0"]}  </#if></td>
            <td colspan="3" align="center"><span class="desc">${item.quantity}</span></td>
            <td  colspan="2"  align="right"  >${currency_symbol} ${(item.amount  * total_exchange)?string[",##0"]} </td>

         </tr>
        </#if>
    </#if>
</#if>
</#if>
</#if>
    </#list><!-- end items -->

    <#list record.item as item>

        <#if item.item?has_content || item.description == "Total Billable Time">
        <#else>
                 <#assign total_expenses = total_expenses + (item.amount  * total_exchange)> 
                   <#assign total_travel = total_travel + (item.amount  * total_exchange)> 
        </#if>
                 <#if (!item.custcol_ilo_travel_number_column?has_content && item.rate!= 0  && item.rate?has_content && (item.item?index_of("Site")<0)  && (item.description?index_of("Discount")<0)) >

    <tr>
        <td  colspan="7" style="text-align:justify; text-justify:none; color:#6D6E70 !important;">  ${item.description} </td>
        <td  colspan="3" align="left"><#if item.rate!= 0>${currency_symbol} ${(item.rate  * total_exchange)?string[",##0"]}  </#if></td>
        <td colspan="3" align="center"><span class="desc">${item.quantity}</span></td>
        <td  colspan="2"  align="right"  >${currency_symbol} ${(item.amount  * total_exchange)?string[",##0"]} </td>
    </tr>
                <#else>
                 <#if (item.custcol_ilo_travel_number_column?has_content) >
                     <#assign total_travel = total_travel + (item.rate  * total_exchange)> 
                 <#else>
                </#if>
              </#if>
               <#if (item?has_next == false &&  record.subsidiary != 'Sygnia INC' && total_travel > 0 )>
                 <tr>
                    <td  colspan="7" style="text-align:justify; color:#6D6E70;text-justify:none; "> Travel And Living On Site </td>
                    <td  colspan="3" align="center"></td>
                    <td colspan="3" align="center"></td>
                    <td   align="right"  colspan="2">${currency_symbol} ${total_travel?string[",##0"]}</td>
                </tr>
             </#if>
    </#list><!-- end items -->

    </#if>
        <tr style="border-bottom:1px solid; border-top:1px solid; margin-top:5px;">
        <td  colspan="13"   align="right" style="padding-right:5px;"><b>TOTAL</b></td>
        <td  colspan="2" align="right"    style="background-color:#d3d3d3; border:1px solid;text-align:right  !important"><b>${currency_symbol} ${(record.subtotal  * total_exchange )?string[",##0"]} </b></td>
        </tr>
         <tr>
        <td colspan="10" style="background-color:#fff;  border:0px"></td>
        <td  colspan="3"  align="right" style="padding-right:5px;">Taxes / VAT </td>
        <td  colspan="2" align="right"   style="background-color:#d3d3d3; border-left:1px solid;border-right:1px solid;  text-align:right !important"><b>${currency_symbol} ${(record.taxtotal  * total_exchange)?string[",##0"]}</b></td>
        </tr>
                 <tr>
        <td colspan="10" style="background-color:#fff;  border:0px"></td>
        <td  colspan="3"  align="right" style="padding-right:5px;">Total Due </td>
        <td  colspan="2" align="right"  style="background-color:#d3d3d3; border:1px solid;text-align:right  !important"><b>${currency_symbol} ${(record.total  * total_exchange)?string[",##0"]}</b></td>
        </tr>
  </table>

    <div style="width:100%;padding-top:40px;"></div>           




    <div style="width:98%;margin-top:${110-(total_lines*2) }px;">
            <span  class="title">
        ${record.custbody_invoice_comment}
    </span>
        <br />
                <table style="width:100%;padding-top:5px; border:1px solid #333 ">
        <tr>
          <td class="title" ><b><u>Please remit payment to:</u></b></td>
          </tr>
          <tr>
            <td class="title">  ${subsidiary.custrecord_remit_payment}</td>
        </tr>       
        </table>
    </div> 

<#if  record.subsidiary != 'Sygnia INC'>
    <#if record.custbody_syg_overall_travel?has_content && record.custbody_syg_overall_travel != "0">
    <pbr></pbr>
    <h2>TRAVEL EXPENSES - DETAILS</h2>
      <#assign lasttravelname  = "None">
       <#assign overall_travel  = 0>
   
     <table  style="width:640px;"  class="linetb" ><!-- start items -->
    <#list record.custbody_syg_print_data?split("^^") as itemrow>
    <#if ((itemrow_index==0) || (itemrow?index_of('**New') > 0))>
        <#assign tripname = ''>
         <#if (itemrow?index_of('**New') >= 0)>
         <#assign tripname = itemrow?substring(0, itemrow?index_of('**New'))?replace('travel','')>
         </#if>
         <tr>
             <td colspan="15" align="center"><b>${tripname}</b> </td>
         </tr>
    <#if (lasttravelname != tripname)>

    <tr>
        <th colspan="3">Consultant</th>
          <th  colspan="3" >Destination</th>
      <th  colspan="3" >Dates</th>
        <th  colspan="3">Description</th>
        <th  colspan="3">Amount</th>
     </tr>
      </#if>
             <#assign lasttravelname  = tripname>
              <#assign itemrow = itemrow?replace('**New','')>

    </#if>
 
    <tr>       
             <#assign total_lines = 0> 
           <#list itemrow?split("^") as item>
                    <#assign total_lines = item_index> 
        <#if item_index==0>
        <#assign rectype = item>
        </#if>
        <#if ((item_index> 0) && (rectype?index_of('travel')  >= 0))>
        <#assign travelname = rectype?replace('travel ','')>
            <#if item?has_next>
               <td  colspan="3" style="text-align:justify; text-justify:none; ">  ${item}  </td>
            <#else>
               <td  colspan="3" style="text-align:justify; text-justify:none; ">${currency_symbol} ${item?replace('~','')?number?string(",##0")} </td>
             </#if>
        </#if>
      </#list><!-- end items -->
    </tr>
    </#list><!-- end itemrows -->

    </table>

    <br />
    <br />

   <table  style="width:640px;margin-top:${350-(total_lines*5) }px;"  class="linetb" >
    <tr>
    <th  colspan="8" >Overall travel expenses</th>
    <th  colspan="3"  style="text-align:right;  padding-left:80px;" >${currency_symbol} ${total_travel?string[",##0"]} </th><th></th>
    </tr>
    </table>
    </#if>
    <#if total_offsite != 0 || total_onsite != 0>

            <pbr></pbr>
    <h2>CONSULTING ${daysorhours_capital} - DETAILS</h2>

    <h3>Consulting ${daysorhours} on site</h3>
    <table  style="width:520px;padding-top:-5px"  class="linetb" ><!-- start items -->
    <#list record.custbody_syg_print_data?split("^^") as itemrow>
    <#if itemrow_index==0>
    <thead>
    <tr>
    <th colspan="6">Consultant</th>
    <th  colspan="6" >Total ${daysorhours}</th>
    </tr>
    </thead>
    </#if>
       
    <tr>      
            <#list itemrow?split("^") as item>
        <#if item_index==0>
        <#assign rectype = item>
        </#if>
        <#if ((item_index> 0) && (rectype == 'Consulting Hours on site'))>
          <td  colspan="5" style=" text-align:left;padding-left:20px; " >  ${item}  </td><td></td>
        </#if>
        <#if ((item?matches(r'[-\+]?[0-9]+') || item?matches(r'[-\+]?[0-9]+\.[0-9]+')) && (rectype == 'Consulting Hours on site'))>
         <#assign totalonsite += item?number>
        </#if>
      </#list><!-- end items -->
    </tr>
    </#list><!-- end itemrows -->
    <tr>
    <th  colspan="6" >Total on site ${daysorhours}</th>
    <th  colspan="5" style="text-align:left; padding-left:20px;" >${totalonsite}</th><th></th>
    </tr>

   </table>
        <br />

        <h3>Consulting ${daysorhours} off site</h3>
    <table  style="width:520px;padding-top:-5px"  class="linetb" ><!-- start items -->
    <#list record.custbody_syg_print_data?split("^^") as itemrow>
    <#if itemrow_index==0>
    <thead>
    <tr>
    <th colspan="6">Consultant</th>
    <th  colspan="6" >Total  ${daysorhours}</th>
    </tr>
    </thead>
    </#if>
       
    <tr>       
            <#list itemrow?split("^") as item>
        <#if item_index==0>
        <#assign rectype = item>

        </#if>
        <#if ((item_index > 0) && (rectype == 'Consulting Hours off site'))>
          <td   colspan="5" style=" text-align:left;padding-left:20px;">  ${item}  </td><td></td>
        <#if item?matches(r'[-\+]?[0-9]+\.[0-9]+') || item?matches(r'[-\+]?[0-9]+')>
         <#assign totaloffsite += item?number>
        </#if>
        </#if>

      </#list><!-- end items -->
    </tr>
    </#list><!-- end itemrows -->
    <tr>
    <th  colspan="6" >Total off site  ${daysorhours}</th>
    <th  colspan="5" style="text-align:left;padding-left:20px">${totaloffsite}</th><th></th>
    </tr>
    </table>


   <table  style="width:520px;bottom:100px;"  class="linetb" >
    <tr>
    <th  colspan="6" >Total Consulting services ${daysorhours} billed</th>
    <th  colspan="5"  style="text-align:left;  padding-left:20px;" >${totalonsite + totaloffsite}</th><th></th>
    </tr>
    </table>
   </#if>
 </#if>
</body>
</pdf>
